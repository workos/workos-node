#!/bin/bash

KEY="node-modules-$(checksum package-lock.json)"
cache restore $KEY

if [[ ! `ls -d ./node_modules 2>/dev/null` ]]; then
   npm install
   cache store $KEY ./node_modules
fi

if [[ ! `ls -d ./node_modules/.bin 2>/dev/null` ]]; then
   npm ci
   cache store $KEY ./node_modules
fi